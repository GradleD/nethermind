// SPDX-FileCopyrightText: 2023 Demerzel Solutions Limited
// SPDX-License-Identifier: LGPL-3.0-only

using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using DotNetty.Buffers;
using FluentAssertions;
using FluentAssertions.Equivalency;
using Nethermind.Core.Crypto;
using Nethermind.Core.Extensions;
using Nethermind.Core.Test.Builders;
using Nethermind.Core.Verkle;
using Nethermind.Db.Rocks;
using Nethermind.Int256;
using Nethermind.Logging;
using Nethermind.Network.P2P.Subprotocols.Verkle.Messages;
using Nethermind.Serialization.Rlp;
using Nethermind.Synchronization.VerkleSync;
using Nethermind.Verkle.Curve;
using Nethermind.Verkle.Tree.Serializers;
using Nethermind.Verkle.Tree.Sync;
using Nethermind.Verkle.Tree.TrieStore;

namespace Nethermind.Verkle.Tree.Test;

public class TestSyncRangesInAHugeVerkleTree
{
    public static Random Random { get; } = new(0);
    public static int numKeys = 2000;

    [TearDown]
    public void CleanTestData()
    {
        string dbPath = VerkleTestUtils.GetDbPathForTest();
        if (Directory.Exists(dbPath))
        {
            Directory.Delete(dbPath, true);
        }
    }

    private Hash256[] GetPedersenPathPool(int pathPoolCount)
    {
        Hash256[] pathPool = new Hash256[pathPoolCount];
        for (int i = 0; i < pathPoolCount; i++)
        {
            byte[] key = new byte[32];
            ((UInt256)i).ToBigEndian(key);
            Hash256 keccak = new Hash256(key);
            pathPool[i] = TestItem.GetRandomKeccak();
        }
        return pathPool;
    }

    [TestCase(DbMode.MemDb)]
    [TestCase(DbMode.PersistantDb)]
    public void GetSyncRangeForBigVerkleTree(DbMode dbMode)
    {
        const int pathPoolCount = 100_000;
        const int numBlocks = 200;
        const int leafPerBlock = 10;
        const int blockToGetIteratorFrom = 180;
        const int initialLeafCount = 10000;

        IVerkleTrieStore store = TestItem.GetVerkleStore(dbMode);
        VerkleTree tree = new(store, LimboLogs.Instance);

        Hash256[] pathPool = GetPedersenPathPool(pathPoolCount);
        SortedDictionary<Hash256, byte[]> leafs = new();
        SortedDictionary<Hash256, byte[]> leafsForSync = new();

        for (int leafIndex = 0; leafIndex < initialLeafCount; leafIndex++)
        {
            byte[] value = new byte[32];
            Random.NextBytes(value);
            Hash256 path = pathPool[Random.Next(pathPool.Length - 1)];
            tree.Insert(path, value);
            leafs[path] = value;
            leafsForSync[path] = value;
        }

        tree.Commit();
        tree.CommitTree(0);


        Hash256 stateRoot180 = Hash256.Zero;
        for (int blockNumber = 1; blockNumber <= numBlocks; blockNumber++)
        {
            for (int accountIndex = 0; accountIndex < leafPerBlock; accountIndex++)
            {
                byte[] leafValue = new byte[32];

                Random.NextBytes(leafValue);
                Hash256 path = pathPool[Random.Next(pathPool.Length - 1)];

                if (leafs.ContainsKey(path))
                {
                    if (!(Random.NextSingle() > 0.5)) continue;
                    // Console.WriteLine($"blockNumber:{blockNumber} uKey:{path} uValue:{leafValue.ToHexString()}");
                    tree.Insert(path, leafValue);
                    leafs[path] = leafValue;
                    if(blockToGetIteratorFrom >= blockNumber) leafsForSync[path] = leafValue;
                    // Console.WriteLine("new values");
                }
                else
                {
                    // Console.WriteLine($"blockNumber:{blockNumber} nKey:{path} nValue:{leafValue.ToHexString()}");
                    tree.Insert(path, leafValue);
                    leafs[path] = leafValue;
                    if(blockToGetIteratorFrom >= blockNumber) leafsForSync[path] = leafValue;
                }
            }

            tree.Commit();
            tree.CommitTree(blockNumber);
            if (blockNumber == blockToGetIteratorFrom) stateRoot180 = tree.StateRoot;
        }

        Stem startStem = Bytes.FromHexString("0x40000000000000000000000000000000000000000000000000000000000000");
        Stem limitStem = Bytes.FromHexString("0x80000000000000000000000000000000000000000000000000000000000000");
        PathWithSubTree[]? range =
            tree._verkleStateStore
                .GetLeafRangeIterator(
                    startStem,
                    limitStem, stateRoot180,10000000)
                .ToArray();

        Stem endStem = range[^1].Path;

        VerkleProof proof = tree.CreateVerkleRangeProof(startStem, endStem, out Banderwagon root);
        IVerkleTrieStore localStore = TestItem.GetVerkleStore(DbMode.MemDb);
        VerkleTree localTree = new(localStore, LimboLogs.Instance);

        bool isTrue = localTree.CreateStatelessTreeFromRange(proof, root, startStem, endStem, range);
        Assert.IsTrue(isTrue);
    }

    [TestCase(DbMode.MemDb)]
    [TestCase(DbMode.PersistantDb)]
    public void GetSyncRangeForBigVerkleTreeAndHealTree(DbMode dbMode)
    {
        const int pathPoolCount = 100_00;
        const int numBlocks1 = 150;
        const int numBlocks2 = 10;
        const int leafPerBlock = 2;
        const int initialLeafCount = 10000;
        const int blockJump = 5;
        const int healingLoop = 5;
        const int numPathInOneHealingLoop = pathPoolCount / (healingLoop * blockJump);

        IVerkleTrieStore remoteStore = TestItem.GetVerkleStore(dbMode);
        VerkleTree remoteTree = new(remoteStore, LimboLogs.Instance);

        IVerkleTrieStore localStore = TestItem.GetVerkleStore(DbMode.MemDb);
        VerkleTree localTree = new(localStore, LimboLogs.Instance);

        Hash256[] pathPool = GetPedersenPathPool(pathPoolCount);
        SortedDictionary<Hash256, byte[]> leafs = new();


        for (int leafIndex = 0; leafIndex < initialLeafCount; leafIndex++)
        {
            byte[] value = new byte[32];
            Random.NextBytes(value);
            Hash256 path = pathPool[Random.Next(pathPool.Length - 1)];
            remoteTree.Insert(path, value);
            leafs[path] = value;
        }
        remoteTree.Commit();
        remoteTree.CommitTree(0);


        for (int blockNumber = 1; blockNumber <= numBlocks1; blockNumber++)
        {
            for (int accountIndex = 0; accountIndex < leafPerBlock; accountIndex++)
            {
                byte[] leafValue = new byte[32];

                Random.NextBytes(leafValue);
                Hash256 path = pathPool[Random.Next(pathPool.Length - 1)];

                if (leafs.ContainsKey(path))
                {
                    if (!(Random.NextSingle() > 0.5)) continue;
                    remoteTree.Insert(path, leafValue);
                    leafs[path] = leafValue;
                }
                else
                {
                    remoteTree.Insert(path, leafValue);
                    leafs[path] = leafValue;
                }
            }

            remoteTree.Commit();
            remoteTree.CommitTree(blockNumber);
        }

        Banderwagon root = default;
        ExecutionWitness executionWitness = default;
        SortedSet<byte[]> update = new(Bytes.Comparer);

        int startingHashIndex = 0;
        int endHashIndex = 0;
        for (int blockNumber = numBlocks1 + 1; blockNumber <= numBlocks1 + blockJump; blockNumber++)
        {
            for (int i = 0; i < healingLoop; i++)
            {
                endHashIndex = startingHashIndex + numPathInOneHealingLoop - 1;
                Console.WriteLine($"{startingHashIndex} {endHashIndex}");
                PathWithSubTree[] range =
                    remoteTree._verkleStateStore
                        .GetLeafRangeIterator(
                            pathPool[startingHashIndex].Bytes.Slice(0,31).ToArray(),
                            pathPool[endHashIndex].Bytes.Slice(0,31).ToArray(),
                            remoteTree.StateRoot, 10000000)
                        .ToArray();
                ProcessSubTreeRange(remoteTree, localTree, blockNumber, remoteTree.StateRoot, range);

                startingHashIndex = endHashIndex + 1;
            }

            if (update.Count != 0)
            {
                // use execution witness to heal
                bool insertedWitness = localTree.InsertIntoStatelessTree(executionWitness, root, false);
                Assert.IsTrue(insertedWitness);
                localTree.CommitTree(0);
            }

            update = new SortedSet<byte[]>(Bytes.Comparer);
            for (int accountIndex = 0; accountIndex < leafPerBlock; accountIndex++)
            {
                byte[] leafValue = new byte[32];
                Random.NextBytes(leafValue);
                Hash256 path = pathPool[Random.Next(pathPool.Length - 1)];

                if (leafs.ContainsKey(path))
                {
                    if (!(Random.NextSingle() > 0.5)) continue;
                    remoteTree.Insert(path, leafValue);
                    leafs[path] = leafValue;
                    update.Add(path.Bytes.ToArray());
                }
                else
                {
                    remoteTree.Insert(path, leafValue);
                    leafs[path] = leafValue;
                    update.Add(path.Bytes.ToArray());
                }
            }

            remoteTree.Commit();
            remoteTree.CommitTree(blockNumber);

            executionWitness = remoteTree.GenerateExecutionWitness(update.ToArray(), out root);
        }

        endHashIndex = startingHashIndex + 1000;
        while (endHashIndex < pathPool.Length - 1)
        {
            endHashIndex = startingHashIndex + 1000;
            if (endHashIndex > pathPool.Length - 1)
            {
                endHashIndex = pathPool.Length - 1;
            }
            Console.WriteLine($"{startingHashIndex} {endHashIndex}");

            PathWithSubTree[] range = remoteTree._verkleStateStore.GetLeafRangeIterator(
                pathPool[startingHashIndex].Bytes.Slice(0,31).ToArray(),
                pathPool[endHashIndex].Bytes.Slice(0,31).ToArray(),
                remoteTree.StateRoot, 100000000).ToArray();
            ProcessSubTreeRange(remoteTree, localTree, numBlocks1 + numBlocks2, remoteTree.StateRoot, range);

            startingHashIndex += 1000;
        }



        if (update.Count != 0)
        {
            // use execution witness to heal
            bool insertedWitness = localTree.InsertIntoStatelessTree(executionWitness, root, false);
            Assert.IsTrue(insertedWitness);
            localTree.CommitTree(0);
        }

        VerkleTreeDumper oldTreeDumper = new();
        VerkleTreeDumper newTreeDumper = new();

        localTree.Accept(oldTreeDumper, localTree.StateRoot);
        remoteTree.Accept(newTreeDumper, remoteTree.StateRoot);

        Console.WriteLine("oldTreeDumper");
        Console.WriteLine(oldTreeDumper.ToString());
        Console.WriteLine("newTreeDumper");
        Console.WriteLine(newTreeDumper.ToString());

        oldTreeDumper.ToString().Should().BeEquivalentTo(newTreeDumper.ToString());

        Assert.IsTrue(oldTreeDumper.ToString().SequenceEqual(newTreeDumper.ToString()));
    }

    private static SubTreeRangeMessage TestSubTreeRangeSerializer(SubTreeRangeMessage message)
    {
        IByteBuffer buffer = PooledByteBufferAllocator.Default.Buffer(1024 * 16);
        SubTreeRangeMessageSerializer ser = new();
        ser.Serialize(buffer, message);
        SubTreeRangeMessage? data = ser.Deserialize(buffer);

        data.Should().BeEquivalentTo(message, options =>
        {
            EquivalencyAssertionOptions<SubTreeRangeMessage>? excluded = options.Excluding(c => c.Name == "RlpLength");
            return excluded
                .Using<Memory<byte>>((context => context.Subject.AsArray().Should().BeEquivalentTo(context.Expectation.AsArray())))
                .WhenTypeIs<Memory<byte>>();
        });
        return data;
    }

    private static VerkleProof TestProofSerialization(VerkleProof proof)
    {
        VerkleProofSerializer ser = new();
        VerkleProof data = ser.Decode(new RlpStream(proof.EncodeRlp()));
        // data.Should().BeEquivalentTo(proof, options =>
        // {
        //     EquivalencyAssertionOptions<VerkleProof>? excluded = options.Excluding(c => c.Name == "RlpLength");
        //     return excluded
        //         .Using<Memory<byte>>((context => context.Subject.AsArray().Should().BeEquivalentTo(context.Expectation.AsArray())))
        //         .WhenTypeIs<Memory<byte>>();
        // });
        return data;
    }

    private static void ProcessSubTreeRange(VerkleTree remoteTree, VerkleTree localTree, int blockNumber, Hash256 stateRoot, PathWithSubTree[] subTrees)
    {
        Stem startingStem = subTrees[0].Path;
        Stem endStem = subTrees[^1].Path;
        // Stem limitHash = Stem.MaxValue;

        VerkleProof proof = remoteTree.CreateVerkleRangeProof(startingStem, endStem, out Banderwagon root);

        var message = new SubTreeRangeMessage()
        {
            PathsWithSubTrees = subTrees,
            Proofs = proof.EncodeRlp()
        };

        VerkleProof newProof = TestProofSerialization(proof);
        SubTreeRangeMessage? newMessage = TestSubTreeRangeSerializer(message);

        bool isTrue = localTree.CreateStatelessTreeFromRange(newProof, root, startingStem, endStem, newMessage.PathsWithSubTrees);
        Assert.IsTrue(isTrue);
    }


    [TestCase(DbMode.MemDb)]
    [TestCase(DbMode.PersistantDb)]
    public void CreateHugeTree(DbMode dbMode)
    {
        long block = 0;
        VerkleTree tree = VerkleTestUtils.GetVerkleTreeForTest(dbMode);
        Dictionary<byte[], byte[]?> kvMap = new(Bytes.EqualityComparer);
        byte[] key = new byte[32];
        byte[] value = new byte[32];
        DateTime start = DateTime.Now;
        for (int i = 0; i < numKeys; i++)
        {
            Random.NextBytes(key);
            Random.NextBytes(value);
            kvMap[key.AsSpan().ToArray()] = value.AsSpan().ToArray();
            tree.Insert((Hash256)key, value);
        }
        DateTime check1 = DateTime.Now;
        tree.Commit();
        tree.CommitTree(block++);
        DateTime check2 = DateTime.Now;
        Console.WriteLine($"{block} Insert: {(check1 - start).TotalMilliseconds}");
        Console.WriteLine($"{block} Flush: {(check2 - check1).TotalMilliseconds}");

        Hash256 requiredStateRoot = Hash256.Zero;
        SortedSet<byte[]> keys = new(Bytes.Comparer);
        for (int i = 10; i < numKeys; i += 10)
        {
            DateTime check5 = DateTime.Now;
            Random.NextBytes(key);
            Random.NextBytes(value);
            for (int j = (i-10); j < i; j += 1)
            {
                Random.NextBytes(key);
                Random.NextBytes(value);
                kvMap[key.AsSpan().ToArray()] = value.AsSpan().ToArray();
                tree.Insert((Hash256)key, value);
                keys.Add(key.AsSpan().ToArray());
            }
            DateTime check3 = DateTime.Now;
            tree.Commit();
            if (block == 180) requiredStateRoot = tree.StateRoot;
            tree.CommitTree(block++);
            DateTime check4 = DateTime.Now;
            Console.WriteLine($"{block} Insert: {(check3 - check5).TotalMilliseconds}");
            Console.WriteLine($"{block} Flush: {(check4 - check3).TotalMilliseconds}");
        }
        DateTime check6 = DateTime.Now;
        Console.WriteLine($"Loop Time: {(check6 - check2).TotalMilliseconds}");
        Console.WriteLine($"Total Time: {(check6 - start).TotalMilliseconds}");


        byte[][] keysArray = keys.ToArray();
        using IEnumerator<KeyValuePair<byte[], byte[]>> rangeEnum =
            tree._verkleStateStore.GetLeafRangeIterator(keysArray[30], keysArray[90], requiredStateRoot).GetEnumerator();

        while (rangeEnum.MoveNext())
        {
            Console.WriteLine($"Key:{rangeEnum.Current.Key.ToHexString()} Value:{rangeEnum.Current.Value.ToHexString()}");
            Assert.That(rangeEnum.Current.Value.SequenceEqual(kvMap[rangeEnum.Current.Key]), Is.True);
        }
    }

    [TestCase(DbMode.MemDb)]
    [TestCase(DbMode.PersistantDb)]
    public void TestEdgeCase(DbMode dbMode)
    {
        Banderwagon root = Banderwagon.FromBytes(Bytes.FromHexString("0x4d4c4bc163482e60c3b3b4a505b3d7c818f2b82e27225cf16203d70a525b30d2"))!.Value;
        byte[] proofs = Bytes.FromHexString(
            "f959c08860246dbb7ee1af91f956e6f8ae9f604c6ea477f3575f78fa6b167934017d203d4ee3613df4340b987120506074f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f60597b5c6777da789fa7b8a54deb213e728e2330b4aecc9bae4d8df796a801f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6094f8a2721833b2c4fb7668fe461f0a9b055420030a206dad9c7e8fb009cff88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f60e21de8a07483d23824b56d0c409207a7f85f631d86c313b61ccb430223cef88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f610fc2f0edbb887a22b8c69657675a1837f61b8fc572bd59c379ce6f1d9eeef88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f616ae7e656c21137748c19d502c90864e8cc99307ba9326a0f38bfb2b09b88f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f61b52241dc524ea2b9ed37497a91f9d3697c943b50fb6c865a85f5e5159e69f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6219f06f755fff91ff5ba1727896f075ae8b205809c2f131c59c1895da0fe1f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6225ead0b3e857e1b65afbc38ee066c803a802d4d6a98e5c9be8ae528e6057f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f623c1cea738d834c29fee59968f4aa4b2baf4fff3ca3606134f275230c43ddf88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6255d31186723f050e3d07daaf81145d0983d9e41b7b1ca5fc5a8851b94a88f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6288546611a43aa17568129c0fc23243ca0205f45746d308f0b9dee4aae5bcf88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8449f62aeef579d8ddaf1f07a24fdef17e07264141c26adb0787a7270bcb838bc0be3e270a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f62c01fcc43d9ea5ce8db5f9cd41df0c127968f08b4089cf1562aa745d91734f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f631fd66257fac20ed0b912ff8027453ea453487e35488bf6e50cf700a102f0f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f63231b1dc3e8af99a8be5f897c9b6eb9cf133aee6932fda4b1a77d8eb2ece9f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f633d599fbcccea7d1bc9214a098689a0c403c77dfcd9c0b0c2c003889d1f6ff88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6369b7dd30cc57035f4e684d95afd3c7f55c05ea5bad7473541e5817bf0bf6f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f636c3f5436b24b1b70f546a25bd108b948f2b3f9f508232b333337c041ccc4f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f636f4006c3e4975c19158d481b83843f1c43095d646a00046c287e90132fa0f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f638d0a23a0b7088a3523817b4b596f06ad619b0f51d1d23eb30981b1b8fa2df88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6397c343c22204c0c3b946392544498024ddd89224220ffae3c5083c7805eef88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f63e0d678d38f62e5a9ab0db7e51c3f5b50953790288db0e8a40542a18958fdf88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a0ca74a00d3ff31601000000000000000000000000000000000000000000000000e202a02d00000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f64154043bdad69fc67b8c630b99d21b0acf7d59c82b6f8b092ed41a535a0e0f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f642689fe696f2af30cdc3aeb72220e75211cdea99d25c78afb48aa9031c471f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f64cd14d32a19b933cea5a7924d45f7757f01baa1171f9b7f6d419ef1693c87f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f65c3b20479388c6ff3c6a94adbcc4ead944b31b249797fdadc5d659fc65f90f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f660cb8e70dae4b52608b99f567712f7be63a0cab17f4cab9545e1efe61f4fef88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6689b346bba3639bf5dba7b4b1d13b951cbd4da6ac13db6e5c6227fa24fcc7f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f67059b51547da63e39cb828428823812bdc1629c87193328db1136ac1cead2f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f675b366ae169956467ee7535e6374b6f74329b7691ca1a6404e3b138f11233f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f67837b7edf77c29cf215c5ec38d2182505c1797cf05953276353ca8ab03dadf88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f67a98c9c106af69d93e26e336fa8ce5748a8b38a71e60f01a1b0ca64791d87f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f67ea2b58b83e5840020c95b7ea780535e8956168fd58176b385374c6c34225f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f686ca070f7f1e5914b39e89fd6fde816409cd7fca4b5b6e6f6a341b4309607f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f68a7ee090173c5d8411eae64b0fc0a29dcf563c76760e3b39d069583d19036f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f68be280d9083fe20a0e2df60203baf83d76a743251c9a3d1279d70b3a98b36f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f68c918735baca92329055d69d6e44b5b1cc74493e06f341971f3a1e5e81051f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f697773a5b8c4718dcb406a2394d882a1e8648d456ca516d2ec96615cad7c5cf88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f69a40cf42a1eef3771f80f024e2cac0d5af89634b139d964de10373c61dc10f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6a0e7911ef88fc35ad380e118604a2785b0e618aeb3bb287f0c280f2c83de2f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a010d9b8b709ea1601000000000000000000000000000000000000000000000000e202a02a00000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6a3463c21f1f645939523a4098f4190df0c1857110a640bc1ff26ae9ee0be1f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a0c262f0dc09141701000000000000000000000000000000000000000000000000e202a02e00000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6a4c0a345dfb6a01904dad02fb176986ad30d41048d7c81fc7bb17981021e3f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6a74cfb00836abdf476cc91967ea800ef1c903ce1d449e5d9a3529e2ba972ff88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a0374a6ab784601701000000000000000000000000000000000000000000000000e202a02a00000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6ac86c5b14ce854ebd3faabb97c37c2cf38e860e463a9b0502e6603b1c80edf88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6b1e35ffd2a6bcfaa35ab02b35a92df022631c4fc3256facc21a3dce7ca311f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6b5d42d751e66d3bcdda0c21bc634f03c5e2bfefa6e6aa3a2c995c6f047d3af88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6b7d7246099a439f890495043c2c12aa9143b0aed326bfea20d4a07dc1ab45f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6ba0ece818258bfd5a5de06887ba26a004576320e417a4df81f6a5454be14df88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6bb00641f2bc1e2e94cdcb23e8dd0434f99bd98115e85b5bfb7fb15fa0d306f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6bf71ec2fc8c834f85f4dff1939a1b5feb2e32f11e4f792dd89ae35a4363cef88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6c1c1bc9b54074ef32f22d907a9db3ff179ab398d10d835566e7ea4c133002f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6c3483962cd0e7158d9ca4a3429afa852959246a95befdb8d88d63708f0c69f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6c4df7fd178d4c9a8d2f45a9cf003d8a2048efbcb1fdff345d68484dd31f65f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6d1dcb5a7b82de83e24f0db3f442493007306b6f678cc4225aefd8606948a8f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6d44e88718e12f4ee6c4afd05f1a73256643a594e3100f93d19af02c73bc1df88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6d5533bf86d1adcf292984e388c3d0fd7ecc4275303575ceb3e494890264e3f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6da49b25af02c4f810edb0b99490e9a1d086e6083b4234174f66a1ef7e97a0f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6e1aac21b5d6a246648b4743942426ed37b18c2d871c9f0a10d34618298bdef88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6e3702b5291d5b761317e121c2fc3d7efec9dbbdf1f3f2d291ced388f2e842f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6e7d213ad9ea2a12d1f097edd7edb9f2a86dea6f5b1286b217a66a75b206dff88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6f03e21a6124608a163784187bf02dec934f45a292efb1561da8a4d8b33e92f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6f098eecc0252b4ba75d434c17b347edac723bcdaa53d9d31c96f6a56fea21f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6f2186cb5f2347e4b29059ad605738b768764d79059f58113f0f0c252686c4f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a0080d91a07b501601000000000000000000000000000000000000000000000000e202a02e00000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6f2c4911b4569830ab30faccff4c53f060e483a761e5166cb3fd16394513e0f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6f973c13836ea3f73c8bfebaac607dfc2016d18ba45bb90c12da4bb6f7c7f3f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a08dabba598eda1601000000000000000000000000000000000000000000000000e202a02a00000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f6ffd31cc5854238534b02bc9af12269d05d08fc3feb808825d44deb6852353f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f706a66dbd5e74a95f4cd188e7929841bf88bc57661bdbcbb879f4c65bd2bc6f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f70b34a5c3a1bd94bf5ddc48755a601026543f13f291d3bbbe52876cc28bb04f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f711ea3e1ee2a9ec54bfccbd165170843522db3ffddb99ed0cc9465a801b0fef88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f71c6b14251c874dc78c748a7f9ab143eeac9ba7502b92ec3d9501c508fdfd1f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f723cd68b63171b41a10b384f8d625db58df3a26e5ec81471efa587e213e70ff88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7252c3792d6c7ea1132c151cddc658fb422c78c380dcf6cef2015f699c8101f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7259c3ee4c932a1333dd35b7fddfeb7b810468d678146a27b257d1c6ccf689f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7272d75e35eef23208d4e388f1fadb04618ad32e173db8e3fa634fcee17c2af88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f72935289bd05bd498a127a918c3fb387bd6082366d90f355be91ce91d5869bf88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f72da437ec55175b44e927503f8671351e6b0f469256092b076f4ba36fdac29f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f72f234e46a1721629a3baf710026e6d68fee4335a127b9b425bbc01804b219f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f737d7e7f311c26c44c97e7770e733a4c9e0bdaa978990693c56385f590fe3ff88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a099e9b7e624c41801000000000000000000000000000000000000000000000000e202a02300000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f73e177ddb1e26e507519991a2549d9b6e9b8dc5a37387a31e56edf3477675ef88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7402458b3e610e697a423d205e9dc4f95f997a23a71cb8f18b0d063ad7cbbdf88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f741879f0c3ccee3b17fdd415efdce16e0479ade780a071c7abb60be5d8bca4f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f74d941c1fb41471fff1ec5ce848a75be4f171a3fd3d26bc2fe0120969b0af5f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f75525aa8333708e802f03a87236535e3369f31925ad3f560992fe7603ffa9df88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f76be63525cc40eae79be459be5871e2f33867b6c755729ebfa71a03005fc10f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f76bfbcdeb27947bae6e5b6ef49b7fb9085029e758c6ce1fcbf1ffaaae507aff88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7732a7bddc12695e74d1bdc36a1cd5a93e5e7b42e1d67feee300a66c9ccb00f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f777d3f68cd3c6f42e5a9354034c9d6db12e463aa8eafc778911db971089056f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f778519270c67f8e34c100e0bf91502cdcda6ea699656aa9a39924507706776f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7793de8fcae23f1afde5ba118158ddb19bd614995b56394b69e49af79cac05f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f77b2ab9116aa62d2af39e955ae367b9315ddd424e02fff4a173074904fe2a1f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7816d945fbcaba55c500ed6b6848e9aad23f3d0e31a35e84df5c22bf05ee13f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f784c3fbefff19968de33e352401acc31cf052c5df2dc1ea478dd18b01a81b4f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7856ebbffea2fead8dae1ea22299db2e52595edabd18fe843e50355728de1df88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f78654a560fb76eae1973787e2e94ec67a31b6bcc607fe07de0d8a4be5597b6f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f789f31d180b9509023b1669adb0d66c501f36cf9508c7654d516d6b7156641f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f78f7be687c817332a59b8f86a3d8a3dc11bab2b3c634471d0b2ffe7101b950f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f78f8fc33586122d9143b6644ac14b5b0ee5df22d2f5f607aecdecf374c4534f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a0666b03a790211701000000000000000000000000000000000000000000000000e202a02c00000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f78fe26c52c58f84ff85a4e1ff26e3d7f8ee82c94bc550534608eda74da87fef88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7952291bf5580c6fc118b456b87bd1e98ea7eb7137c3c9954ea5ef19a99f7af88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f79be86a6da481c33c8ef43775023d95adad9a6d4c09ed6f2d20872d5f0322ff88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f79bf311d7673e25a91bd691d0c638e3363377b10ab1165f089f6cc877c2d50f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7a035041fd87fdb3deb1f82675e0e0eaae016e18192a705179f10a7b36def8f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7a5da72184c604c08cd47bc360ef27310803acaef3b22826cd15eccf476056f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7a8a80b5d51679cb185d388bc3fd941a61d7de81544aa9ac237ec8a0d4d5cdf88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7a9e3956959402ee9596f26c55518548079e9eff67a06b9c9512bd8d19bca2f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7aad24c191ec5c402e410c9c52912797c4d0355f8812b98f9001a1badf3b25f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7b60eb6dd846d85e648f23a52e772f4d024ed92389b0d0800e162aae2acf51f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7b68910e38d3405a5b088abeb8d829c92380b32d458893ef5c281a34ea008ff88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7b989af2e899fd364e76a299e37e441c98ee9b39831427cdb2150cc4cbf77ef88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7b9f2d3a33f962ca4b6f411641ac556f4f7a25321d5db35bc785f768d8467ff88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7bcc63cceb3b2e849a8b09e895452720571b4526bee9d3dc6865094b5f2d54f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7c4d82234cd2f2714e640e96f775246f7031a4804bb927ba8c317b0c44ba62f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a01c9e4ed6009a1601000000000000000000000000000000000000000000000000e202a02e00000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7cc240e43d01f816351060942a1bb5d850560f51adc05349ec8162510f00cdf88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7d4b0e2cb16807e3c02c433c97d91603edbe9d56abb0c955660f8c081d0e1ff88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7d571f74a4c982ca9308d720623ab8d6a60285849f9a2c4b1d7c6ef85664a7f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7dd0728aa97b5a794d24642adfff19b23c6a7a0d631c1983450c09d5bd8323f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7e2a417df9bfc8bda5a4e53ff067277d9ec7402f6c6ae242283f85f584d3d1f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7e69072b4bcd1007cfabc1206023c268416fa1cea7d09de229957f6e442caaf88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7e6f3feaee1b457bdc259c1ab2f370548c59c8a20af30c1b8e9b68cec09ba5f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7e7138c85ba57422aa5982597f2d7bc38b35e94c54d4c5bbba71a4e364db8df88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7f055615503016bb375e5c4a46f70be1b71727c2a17222596d9e9f9143b207f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00100000000000000000000000000000000000000000000000000000000000000e202a00000000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7f468585732956280b9834718489d24d01760641b79365f3bb073ea267e3c6f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a0f8a3a30fc2701701000000000000000000000000000000000000000000000000e202a02800000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7f7070be79e8110ea324c7838f441e0036ffc97e879ef708531cd792f7ca7ff88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7fa260431a5e64972293da8810d5a3781344c6a9f537c9907bbe1a5f1d1eb3f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7fe12ee67e587d5ec260f9fe5292544b92be648b3a6e47dd4a15d245c2e87bf88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470f8ae9f7ffe97205603fb4929c36cb9e3f7b966732fb99fcbded372b893837261ac55f88ce280a00000000000000000000000000000000000000000000000000000000000000000e201a00000000000000000000000000000000000000000000000000000000000000000e202a00100000000000000000000000000000000000000000000000000000000000000e203a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470b902cbf902c8f9025bf90237a09d48b41b36beb1fafe9aca09428585a7839deebd182586950e510e7f56fd1e01f90108a00bbf138356f125a9531b32b22a16ea5200a287fad50f57d0ba0284d9fdf2bf71a00ca5bab722fc4fa7e151de024b05fa18310b51ccc6dfdf197bd2f4e092a0da6da073014e2c6e132871f645732e9d24bd9a36bc77ebb99b2a956d6c649e6b410c9ca0135d12c20b34e1f059f1a4db43e1a68064b667a7d84be928983efa2e766b90f8a05be77be4de5923f8f21b2857d99bf0329bb21849da3ff6abc3189ee1e0a3cd03a00c68c7523dc5d459cabce10fcbee4ef0b72e2fa128c182a486915b334e1c95b9a04d7ecd0b0eb0f67c0c04a0b2b0bc11c06db26476f0fe581ab46638a8c6451482a0170bf0f082a64ff4f77c00bb2b3a87a91b37c6736e1990f36422e0f16d529cd5f90108a01262d99840be11e71cfbc88d27bfb72c9f4f9763ba354e506f540d53de7dd396a00c3daf183c179c2d04efd2684d9135ec6a3ac4391cb13f33bea360880f1b91fea06f1a4464a620f48bc3af9c988e8a684b16d8b040941c89774e5abf68396eab6ca031fbe9dce96e1a2db39ad883d0f9e8dc6093d31dbde5040e9011de946257c4dea006588c9b6caed246dab8b6fda58ffc4fa8ec01fb82f14fcc38fae838708e10a5a01f1d646b9eaff3b89019469fca69e7e4186f9a37143bfc77e46d2ad18167dc3ea03bb153bf3ecf6c19446f92aa054acf60008b685d72f491af020964b4a3451500a00ed4492c9ab1531b73e827074bbc9739a209aae33eb3c605c093b7e2bb1451e0a062aaf3c8244f3cbf193c3dfc2f74b2aad8af3e3dc84a59ddd1b7bc5a41df92fdf863a06ff2e4f05132daaa515bfc97e6263b3db91ca730856def63627aa08425f59958a02fb5724558918b0410d6cfd766097a490713cff6f9a8fdf7462c773413354708a00853c4ee6e716f17fd0c0c9a55b1dd80a442d0aaaa27051d3fed2f7ed15d100ac4c0821012");
        SubTreeRangeMessageSerializer ser = new();
        IByteBuffer byteBuffer = PooledByteBufferAllocator.Default.Buffer(1024 * 16);
        byteBuffer.EnsureWritable(proofs.Length);
        byteBuffer.WriteBytes(proofs);
        SubTreeRangeMessage message = ser.Deserialize(byteBuffer);

        VerkleProofSerializer seProof = VerkleProofSerializer.Instance;
        VerkleProof vProof = seProof.Decode(new RlpStream(message.Proofs));
        IVerkleTrieStore localStore = TestItem.GetVerkleStore(DbMode.MemDb);
        VerkleTree tree = new(localStore, LimboLogs.Instance);
        bool correct = tree.CreateStatelessTreeFromRange(vProof, root,
            new Stem(Bytes.FromHexString("0x60000000000000000000000000000000000000000000000000000000000000")),message.PathsWithSubTrees[^1].Path,
            message.PathsWithSubTrees);

        Assert.IsTrue(correct);

    }

    [TestCase(DbMode.MemDb)]
    [TestCase(DbMode.PersistantDb)]
    public void TestRangeIterator(DbMode dbMode)
    {
        const int pathPoolCount = 100_000;
        const int leafPerBlock = 10;

        IVerkleTrieStore store = TestItem.GetVerkleStore(dbMode);
        VerkleTree tree = new(store, LimboLogs.Instance);

        Hash256[] pathPool = GetPedersenPathPool(pathPoolCount);
        SortedDictionary<Hash256, byte[]> leafs = new();

        for (int leafIndex = 0; leafIndex < 10000; leafIndex++)
        {
            byte[] value = new byte[32];
            Random.NextBytes(value);
            Hash256 path = pathPool[Random.Next(pathPool.Length - 1)];
            tree.Insert(path, value);
            leafs[path] = value;
            Console.WriteLine($"blockNumber:{0} nKey:{path} nValue:{value.ToHexString()}");
        }

        tree.Commit();
        tree.CommitTree(0);

        Hash256 requiredStateRoot = Hash256.Zero;
        for (int blockNumber = 1; blockNumber <= 180; blockNumber++)
        {
            for (int accountIndex = 0; accountIndex < leafPerBlock; accountIndex++)
            {
                byte[] leafValue = new byte[32];

                Random.NextBytes(leafValue);
                Hash256 path = pathPool[Random.Next(pathPool.Length - 1)];

                if (leafs.ContainsKey(path))
                {
                    if (!(Random.NextSingle() > 0.5)) continue;
                    Console.WriteLine($"blockNumber:{blockNumber} uKey:{path} uValue:{leafValue.ToHexString()}");
                    tree.Insert(path, leafValue);
                    leafs[path] = leafValue;
                    Console.WriteLine("new values");
                }
                else
                {
                    Console.WriteLine($"blockNumber:{blockNumber} nKey:{path} nValue:{leafValue.ToHexString()}");
                    tree.Insert(path, leafValue);
                    leafs[path] = leafValue;
                }
            }

            tree.Commit();
            tree.CommitTree(blockNumber);
            if (blockNumber == 180) requiredStateRoot = tree.StateRoot;
            {

            }
        }

        KeyValuePair<byte[], byte[]>[] rangeEnum =
            tree._verkleStateStore.GetLeafRangeIterator(Hash256.Zero.Bytes.ToArray(), Hash256.MaxValue.Bytes.ToArray(), requiredStateRoot)
                .ToArray();

        int index = 0;
        foreach (KeyValuePair<Hash256, byte[]> leaf in leafs)
        {
            Console.WriteLine($"{leaf.Key} {rangeEnum[index].Key.ToHexString()}");
            Console.WriteLine($"{leaf.Value.ToHexString()} {rangeEnum[index].Value.ToArray()}");
            Assert.IsTrue(leaf.Key.Bytes.SequenceEqual(rangeEnum[index].Key));
            Assert.IsTrue(leaf.Value.SequenceEqual(rangeEnum[index].Value));
            index++;
        }
    }
}
